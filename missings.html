<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítol 3 Missings | Preprocesat de dades densitometria i ecocardiograma</title>
  <meta name="description" content="Capítol 3 Missings | Preprocesat de dades densitometria i ecocardiograma" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítol 3 Missings | Preprocesat de dades densitometria i ecocardiograma" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítol 3 Missings | Preprocesat de dades densitometria i ecocardiograma" />
  
  
  

<meta name="author" content="Júlia Cano" />


<meta name="date" content="2024-03-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="outliers.html"/>
<link rel="next" href="descriptiva.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="visualització-i-depurat-de-dades.html"><a href="visualització-i-depurat-de-dades.html"><i class="fa fa-check"></i><b>1</b> Visualització i depurat de dades</a>
<ul>
<li class="chapter" data-level="1.1" data-path="visualització-i-depurat-de-dades.html"><a href="visualització-i-depurat-de-dades.html#ecocardiograma"><i class="fa fa-check"></i><b>1.1</b> Ecocardiograma</a></li>
<li class="chapter" data-level="1.2" data-path="visualització-i-depurat-de-dades.html"><a href="visualització-i-depurat-de-dades.html#densitometria"><i class="fa fa-check"></i><b>1.2</b> Densitometria</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="outliers.html"><a href="outliers.html"><i class="fa fa-check"></i><b>2</b> Outliers</a>
<ul>
<li class="chapter" data-level="2.1" data-path="outliers.html"><a href="outliers.html#densitometria-1"><i class="fa fa-check"></i><b>2.1</b> Densitometria</a></li>
<li class="chapter" data-level="2.2" data-path="outliers.html"><a href="outliers.html#ecocardiograma-1"><i class="fa fa-check"></i><b>2.2</b> Ecocardiograma</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="missings.html"><a href="missings.html"><i class="fa fa-check"></i><b>3</b> Missings</a>
<ul>
<li class="chapter" data-level="3.1" data-path="missings.html"><a href="missings.html#imputació-multiple"><i class="fa fa-check"></i><b>3.1</b> Imputació multiple</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="descriptiva.html"><a href="descriptiva.html"><i class="fa fa-check"></i><b>4</b> Descriptiva</a>
<ul>
<li class="chapter" data-level="4.1" data-path="descriptiva.html"><a href="descriptiva.html#visió-general"><i class="fa fa-check"></i><b>4.1</b> Visió general</a></li>
<li class="chapter" data-level="4.2" data-path="descriptiva.html"><a href="descriptiva.html#descriptiva-de-les-variables-de-densitometriaecocardiogramas-per-sexe-esport-any-i-edat"><i class="fa fa-check"></i><b>4.2</b> Descriptiva de les variables de densitometria/ecocardiogramas per sexe, esport, any i edat</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="visualizació-de-dades-longitudinals.html"><a href="visualizació-de-dades-longitudinals.html"><i class="fa fa-check"></i><b>5</b> Visualizació de dades longitudinals</a></li>
<li class="chapter" data-level="6" data-path="pca-co-inercia-i-anàlisis-de-correlació-canonica.html"><a href="pca-co-inercia-i-anàlisis-de-correlació-canonica.html"><i class="fa fa-check"></i><b>6</b> PCA, co-inercia i anàlisis de correlació canonica</a>
<ul>
<li class="chapter" data-level="6.1" data-path="pca-co-inercia-i-anàlisis-de-correlació-canonica.html"><a href="pca-co-inercia-i-anàlisis-de-correlació-canonica.html#anàlisis-de-components-principalspca"><i class="fa fa-check"></i><b>6.1</b> Anàlisis de Components Principals(PCA)</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="pca-co-inercia-i-anàlisis-de-correlació-canonica.html"><a href="pca-co-inercia-i-anàlisis-de-correlació-canonica.html#representació-gràfica-pca"><i class="fa fa-check"></i><b>6.1.1</b> Representació gràfica PCA</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="pca-co-inercia-i-anàlisis-de-correlació-canonica.html"><a href="pca-co-inercia-i-anàlisis-de-correlació-canonica.html#anàlisis-de-correlació-canònica"><i class="fa fa-check"></i><b>6.2</b> Anàlisis de correlació canònica</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Preprocesat de dades densitometria i ecocardiograma</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="missings" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Capítol  3</span> Missings<a href="missings.html#missings" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Començarem visualitzant la quantitat de missings en cada df (i les variables sense NA’S).</p>
<p>Per tenir una idea de la distribució dels valors perduts utilizarem la seguent gràfica que ens ensenya el patro de distribució. Observem que en les dos bases de dades tenim unes variables que concentraran la majoria de NA’s, sobretot es pot veure a desitometries.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="missings.html#cb1-1" tabindex="-1"></a>missings_eco <span class="ot">&lt;-</span> dfpreeco[, <span class="fu">colSums</span>(<span class="fu">is.na</span>(dfpreeco)) <span class="sc">!=</span> <span class="dv">0</span> ] <span class="sc">%&gt;%</span> <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">&quot;variable&quot;</span>, <span class="at">value =</span> <span class="st">&quot;valor&quot;</span>)</span>
<span id="cb1-2"><a href="missings.html#cb1-2" tabindex="-1"></a>missings_desi <span class="ot">&lt;-</span> dfpredensi[, <span class="fu">colSums</span>(<span class="fu">is.na</span>(dfpredensi)) <span class="sc">!=</span> <span class="dv">0</span> ] <span class="sc">%&gt;%</span>  <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">&quot;variable&quot;</span>, <span class="at">value =</span> <span class="st">&quot;valor&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="missings.html#cb2-1" tabindex="-1"></a><span class="co"># Ecocardiograma</span></span>
<span id="cb2-2"><a href="missings.html#cb2-2" tabindex="-1"></a>missings_summary <span class="ot">&lt;-</span> missings_eco <span class="sc">%&gt;%</span></span>
<span id="cb2-3"><a href="missings.html#cb2-3" tabindex="-1"></a>  <span class="fu">group_by</span>(variable) <span class="sc">%&gt;%</span></span>
<span id="cb2-4"><a href="missings.html#cb2-4" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">percentatges_NA =</span> <span class="dv">100</span> <span class="sc">*</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(valor)) <span class="sc">/</span> <span class="fu">length</span>(valor)) <span class="sc">%&gt;%</span></span>
<span id="cb2-5"><a href="missings.html#cb2-5" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(percentatges_NA))  <span class="co"># Ordenar de forma descendente por el porcentaje de valores ausentes</span></span>
<span id="cb2-6"><a href="missings.html#cb2-6" tabindex="-1"></a></span>
<span id="cb2-7"><a href="missings.html#cb2-7" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> missings_summary, <span class="fu">aes</span>(<span class="at">x =</span> percentatges_NA, <span class="at">y =</span> <span class="fu">reorder</span>(variable, <span class="sc">-</span>percentatges_NA))) <span class="sc">+</span></span>
<span id="cb2-8"><a href="missings.html#cb2-8" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb2-9"><a href="missings.html#cb2-9" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Percentatge valors absents per variable&quot;</span>,</span>
<span id="cb2-10"><a href="missings.html#cb2-10" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Percentatge NAs&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Variable&quot;</span>) <span class="sc">+</span></span>
<span id="cb2-11"><a href="missings.html#cb2-11" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb2-12"><a href="missings.html#cb2-12" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-6-1"></span>
<img src="_main_files/figure-html/unnamed-chunk-6-1.png" alt="Valores perduts ecocardiogrames" width="672" />
<p class="caption">
Figure 3.1: Valores perduts ecocardiogrames
</p>
</div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="missings.html#cb3-1" tabindex="-1"></a><span class="co">#Desitometria</span></span>
<span id="cb3-2"><a href="missings.html#cb3-2" tabindex="-1"></a><span class="co">#columnas amb NA</span></span>
<span id="cb3-3"><a href="missings.html#cb3-3" tabindex="-1"></a>missings_summary <span class="ot">&lt;-</span> missings_desi <span class="sc">%&gt;%</span></span>
<span id="cb3-4"><a href="missings.html#cb3-4" tabindex="-1"></a>  <span class="fu">group_by</span>(variable) <span class="sc">%&gt;%</span></span>
<span id="cb3-5"><a href="missings.html#cb3-5" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">percentatges_NA =</span> <span class="dv">100</span> <span class="sc">*</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(valor)) <span class="sc">/</span> <span class="fu">length</span>(valor)) <span class="sc">%&gt;%</span></span>
<span id="cb3-6"><a href="missings.html#cb3-6" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(percentatges_NA))  <span class="co"># Ordenar de forma descendente por el porcentaje de valores ausentes</span></span>
<span id="cb3-7"><a href="missings.html#cb3-7" tabindex="-1"></a></span>
<span id="cb3-8"><a href="missings.html#cb3-8" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> missings_summary, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(variable, <span class="sc">-</span>percentatges_NA), <span class="at">y =</span> percentatges_NA)) <span class="sc">+</span></span>
<span id="cb3-9"><a href="missings.html#cb3-9" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb3-10"><a href="missings.html#cb3-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Percentatge valors absents per variable&quot;</span>,</span>
<span id="cb3-11"><a href="missings.html#cb3-11" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Variable&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Percentatge NAs&quot;</span>) <span class="sc">+</span></span>
<span id="cb3-12"><a href="missings.html#cb3-12" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb3-13"><a href="missings.html#cb3-13" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb3-14"><a href="missings.html#cb3-14" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-6-2"></span>
<img src="_main_files/figure-html/unnamed-chunk-6-2.png" alt="Valors perduts desitometries" width="672" />
<p class="caption">
Figure 3.2: Valors perduts desitometries
</p>
</div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="missings.html#cb4-1" tabindex="-1"></a><span class="co">#columnes sense NA</span></span>
<span id="cb4-2"><a href="missings.html#cb4-2" tabindex="-1"></a><span class="fu">names</span>(dfpredensi[, <span class="fu">colSums</span>(<span class="fu">is.na</span>(dfpredensi)) <span class="sc">==</span> <span class="dv">0</span> ])</span></code></pre></div>
<pre><code> [1] &quot;Id&quot;                          &quot;Sexe&quot;                       
 [3] &quot;Prova&quot;                       &quot;Data_densi&quot;                 
 [5] &quot;BrazoIzqTejido_g&quot;            &quot;BrazoIzqMagro_g&quot;            
 [7] &quot;BrazoIzqCMO_g&quot;               &quot;BrazoIzqMasaTotal_kfg&quot;      
 [9] &quot;PiernaIzqMagro_g&quot;            &quot;PiernaIzqCMO_g&quot;             
[11] &quot;IzquierdoTotalTejido_g&quot;      &quot;IzquierdoTotalMagro_g&quot;      
[13] &quot;IzquierdoTotalCMO_g&quot;         &quot;IzquierdoTotalMasaTotal_kfg&quot;
[15] &quot;BrazoDchoTejido_g&quot;           &quot;BrazoDchoMagro_g&quot;           
[17] &quot;BrazoDchoCMO_g&quot;              &quot;BrazoDchoMasaTotal_kfg&quot;     
[19] &quot;PiernaDchaMagro_g&quot;           &quot;PiernaDchaCMO_g&quot;            
[21] &quot;DerechoTotalTejido_g&quot;        &quot;DerechoTotalMagro_g&quot;        
[23] &quot;DerechoTotalCMO_g&quot;           &quot;DerechoTotalMasaTotal_kfg&quot;  
[25] &quot;BrazosTejido_g&quot;              &quot;BrazosMagro_g&quot;              
[27] &quot;BrazosCMO_g&quot;                 &quot;BrazosMasaTotal_kfg&quot;        
[29] &quot;PiernasMagro_g&quot;              &quot;PiernasCMO_g&quot;               
[31] &quot;TroncoMagro_g&quot;               &quot;TroncoCMO_g&quot;                
[33] &quot;GinoideMagro_g&quot;              &quot;GinoideCMO_g&quot;               
[35] &quot;TotalTejido_g&quot;               &quot;TotalMagro_g&quot;               
[37] &quot;TotalCMO_g&quot;                  &quot;TotalMasaTotal_kfg&quot;         
[39] &quot;Any&quot;                        </code></pre>
<div id="imputació-multiple" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Imputació multiple<a href="missings.html#imputació-multiple" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Utilitzarem la llibreria MICE per fer una imputació múltiple. Aquesta ens crearà multiples datasets amb diferents imputacions.</p>
<p>Començarem imputant les variables quantitatives amb pmm (Predictive mean matching)</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="missings.html#cb6-1" tabindex="-1"></a>dfpreeco1 <span class="ot">&lt;-</span> dfpreeco <span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="missings.html#cb6-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">where</span>(is.numeric))</span>
<span id="cb6-3"><a href="missings.html#cb6-3" tabindex="-1"></a>dfpredensi1 <span class="ot">&lt;-</span> dfpredensi <span class="sc">%&gt;%</span></span>
<span id="cb6-4"><a href="missings.html#cb6-4" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">where</span>(is.numeric))</span>
<span id="cb6-5"><a href="missings.html#cb6-5" tabindex="-1"></a></span>
<span id="cb6-6"><a href="missings.html#cb6-6" tabindex="-1"></a>initeco <span class="ot">=</span> mice<span class="sc">::</span><span class="fu">mice</span>(dfpreeco1, <span class="at">maxit =</span> <span class="dv">0</span>)</span>
<span id="cb6-7"><a href="missings.html#cb6-7" tabindex="-1"></a>initdensi <span class="ot">=</span> mice<span class="sc">::</span><span class="fu">mice</span>(dfpredensi1, <span class="at">maxit =</span> <span class="dv">0</span>)</span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="missings.html#cb7-1" tabindex="-1"></a><span class="co">#set.seed(123)</span></span>
<span id="cb7-2"><a href="missings.html#cb7-2" tabindex="-1"></a><span class="co">#imputedeco = mice(dfpreeco1, method=initeco$method, predictorMatrix= initeco$predictorMatrix, m=30) </span></span>
<span id="cb7-3"><a href="missings.html#cb7-3" tabindex="-1"></a><span class="co">#set.seed(123)</span></span>
<span id="cb7-4"><a href="missings.html#cb7-4" tabindex="-1"></a><span class="co">#imputeddesi = mice(dfpredensi1, method=initdensi$method, predictorMatrix= initdensi$predictorMatrix, m=30)</span></span>
<span id="cb7-5"><a href="missings.html#cb7-5" tabindex="-1"></a><span class="co">#save(imputedeco, file = &quot;imputedeco.Rdata&quot;)</span></span>
<span id="cb7-6"><a href="missings.html#cb7-6" tabindex="-1"></a><span class="co">#save(imputedensi, file = &quot;imputedensi.Rdata&quot;)</span></span>
<span id="cb7-7"><a href="missings.html#cb7-7" tabindex="-1"></a></span>
<span id="cb7-8"><a href="missings.html#cb7-8" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;imputedensi.Rdata&quot;</span>)</span>
<span id="cb7-9"><a href="missings.html#cb7-9" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;imputedeco.Rdata&quot;</span>)</span></code></pre></div>
<p>Abans de reemplaçar els valors imputats a les nostres bases de dades comprovem les imputacions.
Varien molt segons el dataset utilitzat? Utilitzarem les distribucions de densitat dels valors inicials (blau) i els diferents imputats (vermell). Observem que no canvien molt entre ells i s’assemblen als valors originals.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="missings.html#cb8-1" tabindex="-1"></a><span class="co">#fig.cap=c(&quot;Densidat imputacions ecocardiogrames&quot;)</span></span>
<span id="cb8-2"><a href="missings.html#cb8-2" tabindex="-1"></a><span class="co">#library(lattice)</span></span>
<span id="cb8-3"><a href="missings.html#cb8-3" tabindex="-1"></a><span class="co">#densityplot(imputedeco)</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="missings.html#cb9-1" tabindex="-1"></a><span class="co">#xyplot(imputedeco, Diam_ven_esq_diast  ~ Diam_ven_esq_sist | .imp, pch = 20, cex = 1.4)</span></span></code></pre></div>
<p>Per cada variable obtindrem un dataframe amb 30 columnes d’imputacions i tantes files com NA’s s’hagin d’imputar en aquella variable. Per poder passar a una sola columna farem la mitjana i reemplaçarem a les dades inicials.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="missings.html#cb10-1" tabindex="-1"></a>imputedeco<span class="sc">$</span>imp <span class="ot">&lt;-</span> <span class="fu">map</span>(<span class="fu">map</span>(imputedeco<span class="sc">$</span>imp, rowMeans), <span class="sc">~</span> <span class="fu">data.frame</span>(.x))</span>
<span id="cb10-2"><a href="missings.html#cb10-2" tabindex="-1"></a>imputedensi<span class="sc">$</span>imp <span class="ot">&lt;-</span> <span class="fu">map</span>(<span class="fu">map</span>(imputedensi<span class="sc">$</span>imp, rowMeans), <span class="sc">~</span> <span class="fu">data.frame</span>(.x))</span>
<span id="cb10-3"><a href="missings.html#cb10-3" tabindex="-1"></a></span>
<span id="cb10-4"><a href="missings.html#cb10-4" tabindex="-1"></a>colseco <span class="ot">&lt;-</span><span class="fu">setdiff</span>(<span class="fu">names</span>(dfpreeco), <span class="fu">names</span>(dfpreeco1))</span>
<span id="cb10-5"><a href="missings.html#cb10-5" tabindex="-1"></a>colsdensi <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(<span class="fu">names</span>(dfpredensi), <span class="fu">names</span>(dfpredensi1))</span>
<span id="cb10-6"><a href="missings.html#cb10-6" tabindex="-1"></a></span>
<span id="cb10-7"><a href="missings.html#cb10-7" tabindex="-1"></a>dfpreeco <span class="ot">&lt;-</span> mice<span class="sc">::</span><span class="fu">complete</span>(imputedeco, <span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">bind_cols</span>(dfpreeco[colseco]) </span>
<span id="cb10-8"><a href="missings.html#cb10-8" tabindex="-1"></a>dfpredensi<span class="ot">&lt;-</span> mice<span class="sc">::</span><span class="fu">complete</span>(imputedensi, <span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">bind_cols</span>(dfpredensi[colsdensi])</span></code></pre></div>
<p>Finalment faltaran imputar les variables qualitatives. Ens falten les columnes Seccio, Sexe, Prova, Data i Any.
Per les variables Sexe, Prova, Data i Any no tenim valors faltants.</p>
<p>Per tant només faltarà Secció. De moment eliminem les files amb valors faltants i ens guardem els Id’s sense Secció.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="missings.html#cb11-1" tabindex="-1"></a>naseccioeco <span class="ot">&lt;-</span> dfpreeco  <span class="sc">%&gt;%</span></span>
<span id="cb11-2"><a href="missings.html#cb11-2" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">is.na</span>(Seccio)) <span class="sc">%&gt;%</span> </span>
<span id="cb11-3"><a href="missings.html#cb11-3" tabindex="-1"></a>    <span class="fu">distinct</span>(Id)</span>
<span id="cb11-4"><a href="missings.html#cb11-4" tabindex="-1"></a></span>
<span id="cb11-5"><a href="missings.html#cb11-5" tabindex="-1"></a>nasecciodensi <span class="ot">&lt;-</span>dfpredensi <span class="sc">%&gt;%</span> </span>
<span id="cb11-6"><a href="missings.html#cb11-6" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(Seccio)) <span class="sc">%&gt;%</span> </span>
<span id="cb11-7"><a href="missings.html#cb11-7" tabindex="-1"></a>  <span class="fu">distinct</span>(Id)</span>
<span id="cb11-8"><a href="missings.html#cb11-8" tabindex="-1"></a></span>
<span id="cb11-9"><a href="missings.html#cb11-9" tabindex="-1"></a>NAseccio <span class="ot">&lt;-</span> <span class="fu">rbind</span>(nasecciodensi, naseccioeco) <span class="sc">%&gt;%</span>  <span class="fu">distinct</span>(Id)</span>
<span id="cb11-10"><a href="missings.html#cb11-10" tabindex="-1"></a><span class="fu">save</span>(NAseccio, <span class="at">file =</span> <span class="st">&quot;NAseccio.Rdata&quot;</span>) <span class="co">#Id sense Secció</span></span>
<span id="cb11-11"><a href="missings.html#cb11-11" tabindex="-1"></a></span>
<span id="cb11-12"><a href="missings.html#cb11-12" tabindex="-1"></a>dfpreeco <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(dfpreeco, <span class="at">subset =</span> Seccio)</span>
<span id="cb11-13"><a href="missings.html#cb11-13" tabindex="-1"></a>dfpredensi <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(dfpredensi, <span class="at">subset =</span> Seccio)</span></code></pre></div>
<p>Ara que no tenim missings en les variables edat, podem catagoritzar-les per tercils.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="missings.html#cb12-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb12-2"><a href="missings.html#cb12-2" tabindex="-1"></a><span class="fu">quantile</span>(<span class="fu">c</span>(dfpreeco<span class="sc">$</span>Edat, dfpredensi<span class="sc">$</span>Edat), <span class="at">probs =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>33.33333% 66.66667% 
    16.26     20.47 </code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="missings.html#cb14-1" tabindex="-1"></a><span class="fu">min</span>(<span class="fu">c</span>(dfpreeco<span class="sc">$</span>Edat, dfpredensi<span class="sc">$</span>Edat), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>[1] 4.93</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="missings.html#cb16-1" tabindex="-1"></a><span class="fu">max</span>(<span class="fu">c</span>(dfpreeco<span class="sc">$</span>Edat, dfpredensi<span class="sc">$</span>Edat), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>[1] 69.04</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="missings.html#cb18-1" tabindex="-1"></a>dfpreeco<span class="sc">$</span>Tercil_Edat <span class="ot">&lt;-</span> <span class="fu">cut</span>(dfpreeco<span class="sc">$</span>Edat, <span class="dv">3</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Joves&quot;</span>, <span class="st">&quot;Aduls_Joves&quot;</span>, <span class="st">&quot;Adults&quot;</span>))</span>
<span id="cb18-2"><a href="missings.html#cb18-2" tabindex="-1"></a>dfpredensi<span class="sc">$</span>Tercil_Edat <span class="ot">&lt;-</span> <span class="fu">cut</span>(dfpredensi<span class="sc">$</span>Edat, <span class="dv">3</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Joves&quot;</span>, <span class="st">&quot;Aduls_Joves&quot;</span>, <span class="st">&quot;Adults&quot;</span>))</span></code></pre></div>
<p>Per tant les edats es classificaran en tres grups: Joves (entre 4.93 i 16.26 anys), Adults/Joves (entre 16.26 i 20.47 anys) i Adults (entre 20.47 i 69.04 anys)</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="outliers.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="descriptiva.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
